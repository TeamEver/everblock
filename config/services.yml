services:
    _defaults:
        autowire: true
        autoconfigure: true

    everblock.tools.import:
        class: Everblock\Tools\Command\ImportFileCommand
        public: true
        tags:
            - { name: 'console.command' }

    everblock.tools.import_tab:
        class: Everblock\Tools\Command\ImportTabCommand
        public: true
        tags:
            - { name: 'console.command' }

    everblock.tools.export:
        class: Everblock\Tools\Command\ExportFileCommand
        public: true
        tags:
            - { name: 'console.command' }

    everblock.tools.execute_action:
        class: Everblock\Tools\Command\ExecuteAction
        public: true
        tags:
            - { name: 'console.command' }

    everblock.tools.prettyblocks:
        class: Everblock\Tools\Command\PrettyBlocksCommand
        public: true
        tags:
            - { name: 'console.command' }

    everblock.tools.search_replace:
        class: Everblock\Tools\Command\SearchReplaceCommand
        public: true
        tags:
            - { name: 'console.command' }

    everblock.tools.clean_games:
        class: Everblock\Tools\Command\CleanGameDataCommand
        public: true
        tags:
            - { name: 'console.command' }

    everblock.grid.definition.factory.ever_block:
        class: Everblock\PrestaShopBundle\Grid\Definition\Factory\EverBlockGridDefinitionFactory
        public: true
        arguments:
            - '@translator'
            - '@prestashop.core.hook.dispatcher'

    everblock.grid.data.factory.ever_block:
        class: Everblock\PrestaShopBundle\Grid\Data\Factory\EverBlockGridDataFactory
        public: true
        arguments:
            - '@doctrine.dbal.default_connection'
            - '@prestashop.adapter.legacy.context'
            - '%database_prefix%'

    everblock.grid.factory.ever_block:
        class: PrestaShop\PrestaShop\Core\Grid\GridFactory
        public: true
        arguments:
            - '@everblock.grid.definition.factory.ever_block'
            - '@everblock.grid.data.factory.ever_block'
            - '@prestashop.core.grid.filter.form_factory'
            - '@prestashop.core.hook.dispatcher'

    everblock.form.provider.choices:
        class: Everblock\PrestaShopBundle\Form\Admin\EverBlock\Provider\EverBlockFormChoicesProvider
        public: true
        arguments:
            - '@prestashop.adapter.legacy.context'

    everblock.form.data_provider.ever_block:
        class: Everblock\PrestaShopBundle\Form\Admin\EverBlock\DataProvider\EverBlockFormDataProvider
        public: true
        arguments:
            - '@prestashop.adapter.legacy.context'
            - '@everblock.form.provider.choices'

    everblock.form.command_handler.upsert_ever_block:
        class: Everblock\PrestaShopBundle\Form\Admin\EverBlock\Command\Handler\UpsertEverBlockHandler
        public: true

    everblock.form.handler.ever_block:
        class: Everblock\PrestaShopBundle\Form\Admin\EverBlock\Handler\EverBlockFormHandler
        public: true
        arguments:
            - '@form.factory'
            - '@everblock.form.data_provider.ever_block'
            - '@everblock.form.command_handler.upsert_ever_block'

